DBMS:
sql server

Error:
com.microsoft.sqlserver.jdbc.SQLServerException: There is already an object named '#exposure_cohort' in the database.

SQL:
select de1.person_id as subject_id, de1.cohort_definition_id, de1.cohort_start_date, de1.cohort_end_date, op1.observation_period_end_date
into #exposure_cohort
from
(select person_id, drug_concept_id as cohort_definition_id, drug_era_start_date as cohort_start_date, drug_era_end_date as cohort_end_date, row_number() over (partition by person_id, drug_concept_id order by drug_era_start_date asc) rn1
from ohdsi_cumc_2022q4r1.dbo.drug_era
where drug_concept_id > 0
--and drug_concept_id in (select descendant_concept_id from concept_ancestor where ancestor_concept_id = 1308216)
) de1
inner join ohdsi_cumc_2022q4r1.dbo.observation_period op1
on de1.person_id = op1.person_id
and de1.cohort_start_date >= dateadd(dd,365,op1.observation_period_start_date)
and de1.cohort_start_date <= op1.observation_period_end_date
and de1.rn1 = 1


R version:
R version 4.2.2 Patched (2022-11-10 r83330)

Platform:
x86_64-pc-linux-gnu

Attached base packages:
- stats
- graphics
- grDevices
- utils
- datasets
- methods
- base

Other attached packages:
- HowOften2023 (0.1.0)
- devtools (2.4.5)
- usethis (2.2.1)
- DatabaseConnector (6.2.3)
- SqlRender (1.15.1)